(()=>{"use strict";const e=function(){this.length=0,this.ships=[],this.lost=()=>{for(let e=0;e<5;e++)if(0==this.ships[e].Sunk())return 0;return 1},this.full=()=>5==this.length,this.add=e=>{this.ships.push(e),this.length+=1}},l=function(e,l,t,r){this.type=e,this.length=l,this.cells=t,this.grids=t,this.color=r,this.Sunk=()=>0==this.length?1:0,this.belongs=e=>{for(let l=0;l<this.length;l++)if(e[0]==this.cells[l][0]&e[1]==this.cells[l][1])return l;return-1},this.delete=e=>{this.cells.splice(e,1),this.length+=-1}},t=(e,l,t,r,n)=>function(e,l,t,r){let n=l,i=10*(e[0]-1)+(e[1]-1);if(0==t){if(l>11-e[1])return 0;for(;n>0;){if(""!=r[i].style.backgroundColor)return 0;n+=-1,i+=1}}else{if(l>11-e[0])return 0;for(;n>0;){if(""!=r[i].style.backgroundColor)return 0;n+=-1,i+=10}}return 1}(e,l,t,r)?function(e,l,t,r,n){let i=l,o=10*(e[0]-1)+(e[1]-1),s=[];if(0==t)for(;i>0;)r[o].style.backgroundColor=n,s.push([Math.floor(o/10)+1,o%10+1]),i+=-1,o+=1;else for(;i>0;)r[o].style.backgroundColor=n,s.push([Math.floor(o/10)+1,o%10+1]),i+=-1,o+=10;return s}(e,l,t,r,n):-1;let r=[["Carrier",5,"orange"],["Battleship",4,"red"],["Cruiser",3,"Blue"],["Submarine",3,"green"],["Destroyer",2,"pink"]],n=document.querySelector("#computer"),i=new e;const o=()=>{for(let e=0;e<10;e++)for(let l=0;l<10;l++){let t=document.createElement("div");t.value=[e+1,l+1],n.appendChild(t)}!function(){for(;!i.full();){let e=Math.floor(100*Math.random()),o=n.children[e],s=i.length,h=Math.floor(2*Math.random()),c=t(o.value,r[s][1],h,n.children,r[s][2]);if(-1!=c){let e=new l(r[s][0],r[s][1],c,r[s][2]);i.add(e)}}for(let e=0;e<n.children.length;e++)n.children[e].style.backgroundColor="grey"}()};let s=[],h=[],c={},u={},a=[[1,0],[-1,0],[0,1],[0,-1]],f=()=>{let e=-1,l=h.length,t=0;if(console.log(h,h.length,l),0==l){let l=Math.floor(Math.random()*s.length);e=p.children[s[l]],h.push(e.value),t=1}else if(1==l)for(let l=0;l<4;l++){let r=h[0][0]+a[l][0],n=h[0][1]+a[l][1],i=c[[Math.max(1,Math.min(10,r)),Math.max(1,Math.min(10,n))]];if(0==u[i]){e=p.children[[i]],h.push(e.value),t=1;break}}else{let r=1;if(h[0][0]==h[1][0]&&(r=0),1==r){let r=[Math.min(10,h[l-1][0]+1),h[l-1][1]];if(1==u[c[[Math.min(10,h[l-1][0]+1),h[l-1][1]]]]){for(let n=0;n<l;n++)if(r=[Math.max(1,h[n][0]-1),h[n][1]],0==u[c[r]]){h.push(r),t=1,console.log(h),e=p.children[c[r]];break}}else console.log(r,u[c[r]]),h.push(r),t=1,e=p.children[c[r]]}else{let r=[h[l-1][0],Math.min(10,h[l-1][1]+1)];if(1==u[c[[h[l-1][0],Math.min(10,h[l-1][1]+1)]]]){for(let n=0;n<l;n++)if(r=[h[n][0],Math.max(1,h[n][1]-1)],console.log(r),0==u[c[r]]){h.push(r),t=1,e=p.children[c[r]];break}}else console.log(r,u[c[r]]),h.push(r),t=1,e=p.children[c[r]]}}!function(e){if(""==e.innerHTML){let l=e.value,t=c[l];u[t]=1;for(let t=0;t<5;t++)if(-1!=m.ships[t].belongs(l)){if(m.ships[t].delete(m.ships[t].belongs(l)),0==m.ships[t].length){for(let e=0;e<h.length;e++){let l=s.indexOf(c[h[e]]);s.splice(l,1)}h=[]}return e.style.backgroundColor=m.ships[t].color,e.innerHTML="R",void(m.lost()&&alert("WINNER Computer"))}e.style.backgroundColor="black",e.innerHTML="W";let r=s.indexOf(c[h[h.length-1]]);s.splice(r,1),h.pop()}}(e)};function d(){if("grey"==this.style.backgroundColor){let e=this.value;for(let l=0;l<5;l++)if(-1!=i.ships[l].belongs(e))return i.ships[l].delete(i.ships[l].belongs(e)),console.log(i.ships[l].color),this.style.backgroundColor=i.ships[l].color,f(),void(i.lost()&&alert("WINNER user"));this.style.backgroundColor="black",f()}}let g=[["Carrier",5,"orange"],["Battleship",4,"red"],["Cruiser",3,"Blue"],["Submarine",3,"green"],["Destroyer",2,"pink"]],p=document.querySelector("#user"),m=new e;function b(){if(m.full())o();else{let e=m.length,r=1,i=t(this.value,g[e][1],r,p.children,g[e][2]);if(-1!=i){let t=new l(g[e][0],g[e][1],i,g[e][2]);m.add(t)}if(m.full()){o();for(let e=0;e<p.children.length;e++)p.children[e].removeEventListener("click",b);(()=>{for(let e=0;e<n.children.length;e++)n.children[e].addEventListener("click",d)})(),(()=>{for(let e=0;e<p.children.length;e++)c[p.children[e].value]=e,u[e]=0,s.push(e)})()}}}(()=>{for(let e=0;e<10;e++)for(let l=0;l<10;l++){let t=document.createElement("div");t.value=[e+1,l+1],t.addEventListener("click",b),p.appendChild(t)}})()})();